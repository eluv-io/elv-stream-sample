!function(e){function webpackJsonpCallback(t){for(var a,i,o=t[0],c=t[1],l=t[2],p=0,u=[];p<o.length;p++)i=o[p],n[i]&&u.push(n[i][0]),n[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);for(s&&s(t);u.length;)u.shift()();return r.push.apply(r,l||[]),checkDeferredModules()}function checkDeferredModules(){for(var e,t=0;t<r.length;t++){for(var a=r[t],i=!0,o=1;o<a.length;o++){var s=a[o];0!==n[s]&&(i=!1)}i&&(r.splice(t--,1),e=__webpack_require__(__webpack_require__.s=a[0]))}return e}var t={},n={0:0},r=[];function __webpack_require__(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,__webpack_require__),r.l=!0,r.exports}__webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,n){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(__webpack_require__.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)__webpack_require__.d(n,r,function(t){return e[t]}.bind(null,r));return n},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="";var a=window.webpackJsonp=window.webpackJsonp||[],i=a.push.bind(a);a.push=webpackJsonpCallback,a=a.slice();for(var o=0;o<a.length;o++)webpackJsonpCallback(a[o]);var s=i;r.push([812,1]),checkDeferredModules()}({324:function(e,t,n){var r=n(325);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(33)(r,a);r.locals&&(e.exports=r.locals)},325:function(e,t,n){(e.exports=n(32)(!1)).push([e.i,'*{box-sizing:border-box}html,body{background-color:#fff;color:#222;font-family:-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;font-size:16px;height:100%;margin:0;padding:0}h1{font-size:28px;font-weight:bold;margin:0}h2{font-size:24px;font-weight:bold;margin:0}h3{font-size:20px;font-weight:normal;margin:0}h3.header-with-loader{align-items:center;display:flex;height:30px;justify-content:space-between}h4{color:#222;font-size:16px;font-weight:normal;margin:8px 0 4px}a{text-decoration:none}a,a:visited{color:#555}a.link{display:block}a.image-link{display:flex}ul{display:flex;list-style-type:none;margin:0;padding:0}ul li{display:inline}select{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:url("data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0Ljk1IDEwIj48ZGVmcz48c3R5bGU+LmNscy0xe2ZpbGw6I2ZmZjt9LmNscy0ye2ZpbGw6IzQ0NDt9PC9zdHlsZT48L2RlZnM+PHRpdGxlPmFycm93czwvdGl0bGU+PHJlY3QgY2xhc3M9ImNscy0xIiB3aWR0aD0iNC45NSIgaGVpZ2h0PSIxMCIvPjxwb2x5Z29uIGNsYXNzPSJjbHMtMiIgcG9pbnRzPSIxLjQxIDQuNjcgMi40OCAzLjE4IDMuNTQgNC42NyAxLjQxIDQuNjciLz48cG9seWdvbiBjbGFzcz0iY2xzLTIiIHBvaW50cz0iMy41NCA1LjMzIDIuNDggNi44MiAxLjQxIDUuMzMgMy41NCA1LjMzIi8+PC9zdmc+") no-repeat 98% 50%;border:1px solid #ccc;border-radius:0;cursor:pointer;font-size:16px;height:32px;padding:0 0 0 4px;width:250px}input{height:32px}input,textarea,pre{border:1px solid #ddd;padding:0 4px}pre{font-family:"SFMono-Regular",Consolas,"Liberation Mono",Menlo,Courier,monospace;margin:0;overflow:auto;padding:12px 8px;white-space:pre-wrap;word-wrap:break-word}.-elv-copyable{cursor:pointer}.app{height:100%}.app-container{display:grid;grid-template-columns:100%;grid-template-rows:1fr auto;height:100%;min-height:100%}main{display:flex;height:100%;justify-content:center;width:100%}footer{color:#8c8c8c;padding:8px 16px;text-align:right}.version-hash-entry{align-items:center;display:flex;margin-top:24px}.version-hash-entry input{color:#6c6c6c;font-size:18px;height:2.5em;margin-right:8px;padding-left:8px;width:100%}.version-hash-entry .-elv-button{height:100%;width:200px}.error-message{color:#f33;font-size:16px;padding:16px;text-align:center}.controls-container{display:flex;flex-direction:column;height:100%;width:80%}.controls-container .selection{align-items:center;display:flex;margin:24px 0}.controls-container .selection label{font-weight:bold;width:100px}.controls-container .selection .-elv-tab-container{margin:0}.controls-container .selection .-elv-tab{text-align:center;width:125px}.controls-container .selection .-elv-tab.secondary.selected{background:#1b73e8;color:#fff}.video-container{display:flex;flex-direction:column;justify-content:center}.video-container h1{font-size:24px;margin:32px 0 0;text-align:center}.video-container h3{font-size:14px;font-style:italic;padding:16px 32px}.video-container video{background-color:#000;cursor:pointer;max-height:60vh;width:100%}\n',""])},554:function(e,t){},556:function(e,t){},596:function(e,t){},597:function(e,t){},648:function(e,t){},812:function(e,t,n){"use strict";n.r(t);var r=n(4),a=n.n(r),i=n(21),o=n.n(i),s=n(16),c=n.n(s),l=n(17),p=n.n(l),u=n(18),d=n.n(u),h=n(19),f=n.n(h),v=n(20),m=n.n(v),g=(n(324),n(0)),y=n.n(g),b=n(79),_=n(143),x=n(11),w=n.n(x),k=n(1),M=n.n(k),S=n(316),C=function(){var e=o()(a.a.mark(function _callee(){var e,t,n,r;return a.a.wrap(function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,S.ElvClient.FromConfigurationUrl({configUrl:"https://main.net955304.contentfabric.io/config",viewOnly:!0});case 2:return e=a.sent,t=e.GenerateWallet(),n=t.GenerateMnemonic(),r=t.AddAccountFromMnemonic({mnemonic:n}),a.next=8,e.SetSigner({signer:r});case 8:return a.abrupt("return",e);case 9:case"end":return a.stop()}},_callee)}));return function InitializeClient(){return e.apply(this,arguments)}}(),E=function(){var e=o()(a.a.mark(function _callee2(){var e,t;return a.a.wrap(function _callee2$(n){for(;;)switch(n.prev=n.next){case 0:if(e=["aes-128"],"function"==typeof window.navigator.requestMediaKeySystemAccess){n.next=4;break}return console.log("requestMediaKeySystemAccess not available"),n.abrupt("return",e);case 4:return n.prev=4,t=[{initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4;codecs="mp4a.40.2"'}],videoCapabilities:[{contentType:'video/mp4;codecs="avc1.42E01E"'}]}],n.next=8,navigator.requestMediaKeySystemAccess("com.widevine.alpha",t);case 8:e.push("widevine"),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(4),console.log("No Widevine support detected");case 14:return n.abrupt("return",e);case 15:case"end":return n.stop()}},_callee2,null,[[4,11]])}));return function AvailableDRMs(){return e.apply(this,arguments)}}(),j=function(){var e=o()(a.a.mark(function _callee3(e){var t,n,r,i,o,s,c,l,p;return a.a.wrap(function _callee3$(a){for(;;)switch(a.prev=a.next){case 0:if(t=e.client,n=e.versionHash,r=e.drm,i=t.utils.DecodeVersionHash(n),32===(o=i.objectId).length){a.next=4;break}throw new Error("Invalid version hash");case 4:return a.prev=4,a.next=7,t.ContentObjectMetadata({versionHash:n});case 7:return s=a.sent,a.next=10,t.PlayoutOptions({versionHash:n,protocols:["dash","hls"],drms:r?[r]:[]});case 10:return c=a.sent,a.next=13,t.Rep({versionHash:n,rep:"player_background",channelAuth:!0});case 13:return l=a.sent,a.next=16,t.GenerateStateChannelToken({objectId:o});case 16:return p=a.sent,a.abrupt("return",{metadata:s,playoutOptions:c,posterUrl:l,authToken:p});case 20:throw a.prev=20,a.t0=a.catch(4),console.error("Failed to load content:"),console.error(a.t0),new Error("Failed to load content");case 25:case"end":return a.stop()}},_callee3,null,[[4,20]])}));return function LoadVideo(t){return e.apply(this,arguments)}}(),z=n(317),I=n.n(z),D=n(318),T=n.n(D),A=n(142),N=n.n(A),V=function(e){function Video(e){var t;return c()(this,Video),(t=d()(this,f()(Video).call(this,e))).InitializeVideo=t.InitializeVideo.bind(w()(t)),t}return m()(Video,e),p()(Video,[{key:"InitializeVideo",value:function InitializeVideo(e){if(e){var t=this.props.playoutOptions.playoutUrl;if("hls"===this.props.videoType){t=N()(t).addSearch("player_profile","hls-js").toString();var n=new I.a;n.loadSource(t),n.attachMedia(e)}else{var r=T.a.MediaPlayer().create();if("widevine"===this.props.drm){var a=this.props.playoutOptions.drms.widevine.licenseServers[0];r.setProtectionData({"com.widevine.alpha":{serverURL:a,httpRequestHeaders:{Authorization:"Bearer ".concat(this.props.authToken)},withCredentials:!1}})}r.initialize(e,t,!1)}}}},{key:"render",value:function render(){return y.a.createElement("div",{className:"video-container"},y.a.createElement("h1",null,this.props.metadata.name),y.a.createElement("h3",null,this.props.metadata.description),y.a.createElement("video",{poster:this.props.posterUrl,crossOrigin:"anonymous",ref:this.InitializeVideo,muted:!1,autoPlay:!1,controls:!0,preload:"auto"}))}}]),Video}(y.a.Component);V.propTypes={authToken:M.a.string,drm:M.a.string,metadata:M.a.object,playoutOptions:M.a.object.isRequired,posterUrl:M.a.string,videoType:M.a.string.isRequired};var P=V,L=n(109),H=n(319),O=n(320),q=function Format(e){return"hls"===e?"HLS":"aes-128"===e?"AES-128":e.charAt(0).toUpperCase()+e.slice(1)},R=function(e){function Controls(e){var t;return c()(this,Controls),(t=d()(this,f()(Controls).call(this,e))).state={loading:!0,versionHash:"hq__5DS92kGeb5v3ktMLaDBNxFnAjshM92APZ98SydiczP7vPguFuyJ4Pgz3rL7EZt1TD1Ks5jHW96",videoType:"hls",video:void 0,availableDRMs:[],drm:"aes-128"},t.LoadVideo=t.LoadVideo.bind(w()(t)),t}return m()(Controls,e),p()(Controls,[{key:"componentDidMount",value:function(){var e=o()(a.a.mark(function _callee(){var e;return a.a.wrap(function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E();case 2:return e=t.sent,this.setState({availableDRMs:e}),t.next=6,this.LoadVideo();case 6:case"end":return t.stop()}},_callee,this)}));return function componentDidMount(){return e.apply(this,arguments)}}()},{key:"LoadVideo",value:function(){var e=o()(a.a.mark(function _callee2(){var e,t,n,r,i;return a.a.wrap(function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:if(this.state.versionHash){a.next=2;break}return a.abrupt("return");case 2:return a.prev=2,this.setState({loading:!0,video:void 0}),a.next=6,j({client:this.props.client,versionHash:this.state.versionHash,drm:this.state.drm});case 6:e=a.sent,t=e.metadata,n=e.playoutOptions,r=e.posterUrl,i=e.authToken,this.setState({loading:!1,videoType:Object.keys(n)[0],video:{metadata:t,playoutOptions:n,posterUrl:r,authToken:i}}),a.next=17;break;case 14:a.prev=14,a.t0=a.catch(2),this.setState({error:a.t0});case 17:case"end":return a.stop()}},_callee2,this,[[2,14]])}));return function LoadVideo(){return e.apply(this,arguments)}}()},{key:"DrmSelector",value:function DrmSelector(){var e=this;if(this.state.loading)return null;var t=this.state.availableDRMs.map(function(e){return[q(e),e]});return y.a.createElement("div",{className:"selection"},y.a.createElement("label",{htmlFor:"drm"},"DRM"),y.a.createElement(L.a,{options:t,selected:this.state.drm,onChange:function onChange(t){e.state.drm!==t&&e.setState({drm:t},e.LoadVideo)},className:"secondary"}))}},{key:"TypeSelector",value:function TypeSelector(){var e=this;if(this.state.loading)return null;var t=Object.keys(this.state.video.playoutOptions).map(function(e){return[q(e),e]});return y.a.createElement("div",{className:"selection"},y.a.createElement("label",{htmlFor:"protocol"},"Protocol"),y.a.createElement(L.a,{options:t,selected:this.state.videoType,onChange:function onChange(t){return e.setState({videoType:t})},className:"secondary"}))}},{key:"VersionHashEntry",value:function VersionHashEntry(){var e=this;return y.a.createElement("div",{className:"version-hash-entry"},y.a.createElement("input",{type:"text",placeholder:"Version Hash",value:this.state.versionHash,onChange:function onChange(t){return e.setState({versionHash:t.target.value})},onKeyPress:Object(_.b)(function(){return e.LoadVideo()})}),y.a.createElement(H.a,{onClick:this.LoadVideo},"Load Content"))}},{key:"ErrorMessage",value:function ErrorMessage(){return this.state.error?y.a.createElement("div",{className:"error-message"},this.state.error.message):null}},{key:"Video",value:function Video(){return this.state.loading?null:y.a.createElement(P,{key:"video-".concat(this.state.videoType),authToken:this.state.video.authToken,drm:this.state.drm,metadata:this.state.video.metadata,playoutOptions:this.state.video.playoutOptions[this.state.videoType],posterUrl:this.state.video.posterUrl,videoType:this.state.videoType})}},{key:"render",value:function render(){return y.a.createElement("div",{className:"controls-container"},this.VersionHashEntry(),this.ErrorMessage(),this.Video(),y.a.createElement(O.a,{loading:this.state.loading&&!this.state.error,fullPage:!0},y.a.createElement("div",{className:"controls"},this.DrmSelector(),this.TypeSelector())))}}]),Controls}(y.a.Component);R.propTypes={client:M.a.object.isRequired};var G=R,Z=function(e){function App(e){var t;return c()(this,App),(t=d()(this,f()(App).call(this,e))).state={client:void 0},t}return m()(App,e),p()(App,[{key:"componentDidMount",value:function(){var e=o()(a.a.mark(function _callee(){return a.a.wrap(function _callee$(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.client){e.next=2;break}return e.abrupt("return");case 2:return e.t0=this,e.next=5,C();case 5:e.t1=e.sent,e.t2={client:e.t1},e.t0.setState.call(e.t0,e.t2);case 8:case"end":return e.stop()}},_callee,this)}));return function componentDidMount(){return e.apply(this,arguments)}}()},{key:"App",value:function App(){return this.state.client?y.a.createElement(G,{client:this.state.client}):y.a.createElement(_.a,{loading:!0,fullPage:!0})}},{key:"render",value:function render(){var e="https://github.com/eluv-io/stream-sample";return y.a.createElement("div",{className:"app-container"},y.a.createElement("main",null,this.App()),y.a.createElement("footer",null,"Source available at ",y.a.createElement("a",{href:e,target:"_blank"},e)))}}]),App}(y.a.Component);Object(b.render)(y.a.createElement(Z,null),document.getElementById("app"))}});